<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML><head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="description" content="ThreatExpert Report: Backdoor.Win32.Farfli">
<style type="text/css">body a {color: #505050;	text-decoration: none} body a:hover {color: #c00000; text-decoration: underline}</style>
<link href="./css/report.css" rel="stylesheet" type="text/css"/>
<title>ThreatExpert Report: Backdoor.Win32.Farfli</title>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
<script type="text/javascript">_uacct = "UA-1490218-5";_udn="threatexpert.com";urchinTracker();</script>
</head><body>
<table align="right"><tr class="top_link"><td><a href="http://www.threatexpert.com">Visit ThreatExpert web site</a></td>
<td style="color: #707070">|</td><td><a href="javascript:window.close();">Close Report</a></td></tr></table>
<a href="http://www.threatexpert.com"><img src="./resources/logo.gif" style="border: none"/></a>
<h2>Submission Summary:</h2>
<ul><li>Submission details:</li><ul>
<li>Submission received: 22 March 2016, 08:41:09</li>
<li>Processing time: 5 min 36 sec</li>
<li>Submitted sample:</li>
<ul>
<li>File MD5: 0x6B768D94AAF655DAC7C480D44645DF23</li>
<li>File SHA-1: 0x1B9E5C71286775DABF225C87C6794CF39569DD12</li>
<li>Filesize: 224,276 bytes</li>
<li>Alias: <a href="http://www.threatexpert.com/threats/backdoor-win32-farfli.html" target="_blank">Backdoor.Win32.Farfli<img src="./resources/flag.gif" style="border:none"/></a> [Ikarus]</li>
</ul>
</ul></ul>
<ul><li>Summary of the findings:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0" width="570px">
<tr><td class="cell_1_h">What's been found</td><td class="cell_2_h">Severity Level</td></tr>
<tr><td class="cell_1">Produces outbound traffic.</td><td class="cell_2"><img src="./resources/level1.gif"></td></tr>
<tr><td class="cell_1">Creates a startup registry entry.</td><td class="cell_2"><img src="./resources/level2.gif"></td></tr>
</table></p>
<p>&nbsp;</p><h2>Technical Details:</h2>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/mem_mod.gif"/></td><td width="100%" class="h3">Memory Modifications</td></tr></table>
<ul><li>There were new processes created in the system:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0">
<tr><td class="cell_1_h">Process Name</td><td class="cell_1_h">Process Filename</td><td class="cell_2_h">Main Module Size</td></tr>
<tr><td class="cell_1">nannaa.exe</td><td class="cell_1">%System%\nannaa.exe</td><td class="cell_2">258,048 bytes</td></tr>
<tr><td class="cell_1">[filename of the sample #1]</td><td class="cell_1">[file and pathname of the sample #1]</td><td class="cell_2">258,048 bytes</td></tr>
</table></p>
<ul><li>Note:</li><ul>
<li>%System% is a variable that refers to the System folder. By default, this is C:\Windows\System (Windows 95/98/Me), C:\Winnt\System32 (Windows NT/2000), or C:\Windows\System32 (Windows XP).</li>
</ul></ul>
<ul><li>There was a new service created in the system:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0">
<tr><td class="cell_1_h">Service Name</td><td class="cell_1_h">Display Name</td><td class="cell_1_h">Status</td><td class="cell_2_h">Service Filename</td></tr>
<tr><td class="cell_1">ctfonn</td><td class="cell_1">DirectX Remover yta for Windows</td><td class="cell_1">"Starting"</td><td class="cell_2">%System%\nannaa.exe</td></tr>
</table></p>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/reg_mod.gif"/></td><td width="100%" class="h3">Registry Modifications</td></tr></table>
<ul><li>The following Registry Keys were created:</li>
<ul>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\MediaResources\msvideo</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\LEGACY_CTFONN</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\LEGACY_CTFONN\0000</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\LEGACY_CTFONN\0000\Control</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\ctfonn</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\ctfonn\Security</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\ctfonn\Enum</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\MediaResources\msvideo</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_CTFONN</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_CTFONN\0000</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_CTFONN\0000\Control</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\ctfonn</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\ctfonn\Security</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\ctfonn\Enum</li>
</ul></ul>
<ul><li>The newly created Registry Values are:</li><ul>
<li>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Run]</li><ul>
<li>svc = "%System%\nannaa.exe"</li>
</ul>
<br/>
<em>so that %System%\nannaa.exe runs every time Windows starts</em><br/>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\LEGACY_CTFONN\0000\Control]</li><ul>
<li>*NewlyCreated* = 0x00000000</li>
<li>ActiveService = "ctfonn"</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\LEGACY_CTFONN\0000]</li><ul>
<li>Service = "ctfonn"</li>
<li>Legacy = 0x00000001</li>
<li>ConfigFlags = 0x00000000</li>
<li>Class = "LegacyDriver"</li>
<li>ClassGUID = "{8ECC055D-047F-11D1-A537-0000F8753ED1}"</li>
<li>DeviceDesc = "DirectX Remover yta for Windows"</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\LEGACY_CTFONN]</li><ul>
<li>NextInstance = 0x00000001</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\ctfonn\Enum]</li><ul>
<li>0 = "Root\LEGACY_CTFONN\0000"</li>
<li>Count = 0x00000001</li>
<li>NextInstance = 0x00000001</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\ctfonn\Security]</li><ul>
<li>Security = 01 00 14 80 90 00 00 00 9C 00 00 00 14 00 00 00 30 00 00 00 02 00 1C 00 01 00 00 00 02 80 14 00 FF 01 0F 00 01 01 00 00 00 00 00 01 00 00 00 00 02 00 60 00 04 00 00 00 00 00 14 00 FD 01 02 00 01 01 00 00 00 00 00 05 12 00 00 00 00 00 18 00 FF 01 0F 0</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\ctfonn]</li><ul>
<li>Type = 0x00000110</li>
<li>Start = 0x00000002</li>
<li>ErrorControl = 0x00000000</li>
<li>ImagePath = "%System%\nannaa.exe"</li>
<li>DisplayName = "DirectX Remover yta for Windows"</li>
<li>ObjectName = "LocalSystem"</li>
<li>Description = "Microsoft(R) DirectX mid for Windows"</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_CTFONN\0000\Control]</li><ul>
<li>*NewlyCreated* = 0x00000000</li>
<li>ActiveService = "ctfonn"</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_CTFONN\0000]</li><ul>
<li>Service = "ctfonn"</li>
<li>Legacy = 0x00000001</li>
<li>ConfigFlags = 0x00000000</li>
<li>Class = "LegacyDriver"</li>
<li>ClassGUID = "{8ECC055D-047F-11D1-A537-0000F8753ED1}"</li>
<li>DeviceDesc = "DirectX Remover yta for Windows"</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_CTFONN]</li><ul>
<li>NextInstance = 0x00000001</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\ctfonn\Enum]</li><ul>
<li>0 = "Root\LEGACY_CTFONN\0000"</li>
<li>Count = 0x00000001</li>
<li>NextInstance = 0x00000001</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\ctfonn\Security]</li><ul>
<li>Security = 01 00 14 80 90 00 00 00 9C 00 00 00 14 00 00 00 30 00 00 00 02 00 1C 00 01 00 00 00 02 80 14 00 FF 01 0F 00 01 01 00 00 00 00 00 01 00 00 00 00 02 00 60 00 04 00 00 00 00 00 14 00 FD 01 02 00 01 01 00 00 00 00 00 05 12 00 00 00 00 00 18 00 FF 01 0F 0</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\ctfonn]</li><ul>
<li>Type = 0x00000110</li>
<li>Start = 0x00000002</li>
<li>ErrorControl = 0x00000000</li>
<li>ImagePath = "%System%\nannaa.exe"</li>
<li>DisplayName = "DirectX Remover yta for Windows"</li>
<li>ObjectName = "LocalSystem"</li>
<li>Description = "Microsoft(R) DirectX mid for Windows"</li>
</ul>
</ul></ul>
<ul><li>The following Registry Values were modified:</li><ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\ServiceCurrent]</li><ul>
<li>(Default) = </li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\ServiceCurrent]</li><ul>
<li>(Default) = </li>
</ul>
</ul></ul>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/other_mod.gif"/></td><td width="100%" class="h3">Other details</td></tr></table>
<ul><li>To mark the presence in the system, the following Mutex objects were created:</li>
<ul>
<li>c:\windows\system32\sample_1.exe</li>
<li>C:\WINDOWS\system32\nannaa.exe</li>
<li>447556707.com</li>
</ul></ul>
<ul><li>The following Host Names were requested from a host database:</li>
<ul>
<li>192.5.5.241</li>
<li>447556707.com</li>
</ul></ul>
<ul><li>There was registered attempt to establish connection with the remote host. The connection details are:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0">
<tr><td class="cell_1_h">Remote Host</td><td class="cell_2_h">Port Number</td></tr>
<tr><td class="cell_1">447556707.com<td class="cell_2">8009</td><tr>
</table></p>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/traffic_mod.gif"/></td><td width="100%" class="h3">Outbound traffic (potentially malicious)</td></tr></table>
<ul><li>There was an outbound traffic produced on port 8009:</li></ul>
<p><table class="tbl" cellpadding="0" cellspacing="0"><tr><td>
<textarea style="color:#505050;border-style:none; font-family:'Courier New', Courier, mono; font-size:11px" name="textarea" cols="80" rows="7">
00000000 | 0B01 0000 789C 4B63 6660 98C3 C0C0 C00A | ....x.Kcf`......
00000010 | C48C 40AC C1C5 C0C0 04A4 8353 8BCA 3293 | ..@........S..2.
00000020 | 5315 0212 93B3 158C 180A FD95 9D18 DE00 | S...............
00000030 | C5C3 381A 6B24 8034 8301 03C3 9FFF 7B19 | ..8.k$.4......{.
00000040 | 1418 10C0 24FA 2C98 168E 5B5A 7826 6669 | ....$.,...[Zx&fi
00000050 | 2188 7DA0 4584 C1A3 4A84 A1E3 B908 58EE | !.}.E...J.....X.
00000060 | 4FF8 5986 A981 4B0B 2540 7CA0 660D A0A5 | O.Y...K.%@|.f...
00000070 | 2A40 FCFF 3FD0 5E01 0686 2D40 7116 0688 | *@..?.^...-@q...
00000080 | 1B18 1819 19B6 7343 DC55 0FA4 9CF3 730B | ......sC.U....s.
00000090 | 4A4B 528B FC12 7353 1988 0420 F701 8D66 | JKR...sS... ...f
000000A0 | F074 3DFB E3D0 5B06 8606 A838 C84C 3EA0 | .t=...[....8.L>.
000000B0 | 2D1F 1941 26FF F879 16EC 4A08 F813 7A96 | -..A&..y..J...z.
000000C0 | 61D9 8532 4386 88B3 0C3C 40AC 1179 96E1 | a..2C....<@..y..
000000D0 | 44E1 F2C2 86F0 A585 FF81 A002 48AF 0FD5 | D...........H...
000000E0 | D5D7 6510 6178 1175 9601 E86C 8633 A14B | ..e.ax.u...l.3.K
000000F0 | 0B9F 8442 FCBC 795E 430D 882E E56E ACD9 | ...B..y^C....n..
00000100 | 0EA4 0165 504E 5464 0100 00             | ...ePNTd...
</textarea></tr></td></table></p>
<p>&nbsp;</p><div class="discl">
<table cellpadding="0" cellspacing="0" style="width:100%"><tr><td width="100%" class="h3">&nbsp;</td></tr></table>
<p>All content ("Information") contained in this report is the copyrighted work of Threat Expert Ltd and its associated companies ("ThreatExpert") and may not be copied without the express permission of ThreatExpert.</p>
<p>The Information is provided on an "as is" basis. ThreatExpert disclaims all warranties, whether express or implied, to the maximum extent permitted by law, including the implied warranties that the Information is merchantable, of satisfactory quality, accurate, fit for a particular purpose or need, or non-infringing, unless such implied warranties are legally incapable of exclusion. Further, ThreatExpert does not warrant or make any representations regarding the use or the results of the use of the Information in terms of their correctness, accuracy, reliability, or otherwise.</p>
<p style="color: #000000">Copyright &copy; 2016 <a href="http://www.threatexpert.com" style="color: #000000">ThreatExpert</a>. All rights reserved.</p></div>
</body></html>
