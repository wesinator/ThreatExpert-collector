<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML><head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="description" content="ThreatExpert Report: Trojan.ATRAPS">
<style type="text/css">body a {color: #505050;	text-decoration: none} body a:hover {color: #c00000; text-decoration: underline}</style>
<link href="./css/report.css" rel="stylesheet" type="text/css"/>
<title>ThreatExpert Report: Trojan.ATRAPS</title>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
<script type="text/javascript">_uacct = "UA-1490218-5";_udn="threatexpert.com";urchinTracker();</script>
</head><body>
<table align="right"><tr class="top_link"><td><a href="http://www.threatexpert.com">Visit ThreatExpert web site</a></td>
<td style="color: #707070">|</td><td><a href="javascript:window.close();">Close Report</a></td></tr></table>
<a href="http://www.threatexpert.com"><img src="./resources/logo.gif" style="border: none"/></a>
<h2>Submission Summary:</h2>
<ul><li>Submission details:</li><ul>
<li>Submission received: 16 May 2016, 08:58:51</li>
<li>Processing time: 7 min 2 sec</li>
<li>Submitted sample:</li>
<ul>
<li>File MD5: 0x53084B4A204FBCDEAEF9D9CF3BC68EBD</li>
<li>File SHA-1: 0x8EDCB6485595EF2BB6C9FDCA2D06966C770E07A9</li>
<li>Filesize: 3,604,480 bytes</li>
<li>Alias &amp; packer info:</li>
<ul><li><a href="http://www.threatexpert.com/threats/trojan-atraps.html" target="_blank">Trojan.ATRAPS<img src="./resources/flag.gif" style="border:none"/></a> [Ikarus]</li>
<li><em>packed with: </em>ASPack [Kaspersky Lab]</li>
</ul>
</ul>
</ul></ul>
<ul><li>Summary of the findings:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0" width="570px">
<tr><td class="cell_1_h">What's been found</td><td class="cell_2_h">Severity Level</td></tr>
<tr><td class="cell_1">Downloads/requests other files from Internet.</td><td class="cell_2"><img src="./resources/level1.gif"></td></tr>
<tr><td class="cell_1">Creates a startup registry entry.</td><td class="cell_2"><img src="./resources/level2.gif"></td></tr>
</table></p>
<p>&nbsp;</p><h2>Technical Details:</h2>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/file_mod.gif"/></td><td width="100%" class="h3">File System Modifications</td></tr></table>
<ul><li>The following directories were created:</li>
<ul>
<li>%AppData%\ttll</li>
<li>%Temp%\CookieCache</li>
</ul></ul>
<ul><li>Notes:</li><ul>
<li>%AppData% is a variable that refers to the file system directory that serves as a common repository for application-specific data. A typical path is C:\Documents and Settings\[UserName]\Application Data.</li>
<li>%Temp% is a variable that refers to the temporary folder in the short path form. By default, this is C:\Documents and Settings\[UserName]\Local Settings\Temp\ (Windows NT/2000/XP).</li>
</ul></ul>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/mem_mod.gif"/></td><td width="100%" class="h3">Memory Modifications</td></tr></table>
<ul><li>There were new processes created in the system:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0">
<tr><td class="cell_1_h">Process Name</td><td class="cell_1_h">Process Filename</td><td class="cell_2_h">Main Module Size</td></tr>
<tr><td class="cell_1">updatezb.exe</td><td class="cell_1">%Windir%\updatezb.exe</td><td class="cell_2">151,552 bytes</td></tr>
<tr><td class="cell_1">wbmoney.exe</td><td class="cell_1">%Windir%\wbmoney.exe</td><td class="cell_2">585,728 bytes</td></tr>
<tr><td class="cell_1">[filename of the sample #1]</td><td class="cell_1">[file and pathname of the sample #1]</td><td class="cell_2">8,806,400 bytes</td></tr>
<tr><td class="cell_1">tbviewer.exe</td><td class="cell_1">%Windir%\tbviewer.exe</td><td class="cell_2">3,264,512 bytes</td></tr>
</table></p>
<ul><li>Notes:</li><ul>
<li>%Windir% is a variable that refers to the Windows installation folder. By default, this is C:\Windows or C:\Winnt.</li>
</ul></ul>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/reg_mod.gif"/></td><td width="100%" class="h3">Registry Modifications</td></tr></table>
<ul><li>The following Registry Keys were created:</li>
<ul>
<li>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BROWSER_EMULATION</li>
<li>HKEY_CURRENT_USER\Software\Local AppWizard-Generated Applications</li>
<li>HKEY_CURRENT_USER\Software\Local AppWizard-Generated Applications\TbViewer90</li>
<li>HKEY_CURRENT_USER\Software\Local AppWizard-Generated Applications\TbViewer90\Workspace</li>
<li>HKEY_CURRENT_USER\Software\Local AppWizard-Generated Applications\TbViewer90\Workspace\ControlBars-Summary</li>
<li>HKEY_CURRENT_USER\Software\??Ã³???????????????Ã³???</li>
<li>HKEY_CURRENT_USER\Software\??Ã³???????????????Ã³???\???</li>
<li>HKEY_CURRENT_USER\Software\??Ã³???????????????Ã³???\???\Settings</li>
</ul></ul>
<ul><li>The newly created Registry Values are:</li><ul>
<li>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BROWSER_EMULATION]</li><ul>
<li>tbviewer.exe = 0x0000270F</li>
</ul>
<li>[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run]</li><ul>
<li>LiuLiangZB = ""%Windir%\wbmoney.exe" /autorun"</li>
</ul>
<br/>
<em>so that %Windir%\wbmoney.exe runs every time Windows starts</em><br/>
<li>[HKEY_CURRENT_USER\Software\??Ã³???????????????Ã³???\???\Settings]</li><ul>
<li>c_bInPrivateMode = 0x00000000</li>
<li>c_bClearCookie = 0x00000001</li>
<li>c_bClearCache = 0x00000000</li>
<li>c_bNotActiveX = 0x00000001</li>
<li>c_bStrictCheckCookie = 0x00000000</li>
<li>c_bFlowCheckCookie = 0x00000001</li>
<li>c_bExitIfRefNavFail = 0x00000001</li>
</ul>
</ul></ul>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/other_mod.gif"/></td><td width="100%" class="h3">Other details</td></tr></table>
<ul><li>To mark the presence in the system, the following Mutex objects were created:</li>
<ul>
<li>_!SHMSFTHISTORY!_</li>
<li>DirectSound Administrator shared thread array (lock)</li>
</ul></ul>
<ul><li>The following ports were open in the system:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0">
<tr><td class="cell_1_h">Port</td><td class="cell_1_h">Protocol</td><td class="cell_2_h">Process</td></tr>
<tr><td class="cell_1">1038</td><td class="cell_1">UDP</td><td class="cell_2">wbmoney.exe (%Windir%\wbmoney.exe)</td></tr>
<tr><td class="cell_1">1046</td><td class="cell_1">TCP</td><td class="cell_2">wbmoney.exe (%Windir%\wbmoney.exe)</td></tr>
</table></p>
<ul><li>The following Internet Connections were established:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0">
<tr><td class="cell_1_h">Server Name</td><td class="cell_1_h">Server Port</td><td class="cell_1_h">Connect as User</td><td class="cell_2_h">Connection Password</td></tr>
<tr><td class="cell_1">www.4345.cc</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">6688.huanips.com</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">6688.qqshuoyu.com</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">6688.6299.cc</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">6688.wangbaoma.com</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">user.ttliuliang.com</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">auto.m.ttsoft.cn</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">user1.m.ttsoft.cn</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">login2.m.ttsoft.cn</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">int.dpool.sina.com.cn</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">www.ip.cn</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">ip.chinaz.com</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">1212.ip138.com</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">ip-api.com</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
<tr><td class="cell_1">flow7.softfw.com</td><td class="cell_1">80</td><td class="cell_1">(null)</td><td class="cell_2">(null)</td></tr>
</table></p>
<ul><li>The following GET requests were made:</li>
<ul>
<li>rj/flowtips.html</li>
<li>rj/index.jpg</li>
<li>clnt/tips_flownews.htm</li>
<li>clnt/index.jpg</li>
<li>iplookup/iplookup.php?format=js</li>
<li>index.html</li>
<li>getip.aspx</li>
<li>ic.asp</li>
<li>json</li>
</ul></ul>
<ul><li>The data identified by the following URLs was then requested from the remote web server:</li>
<ul>
<li>http://down.9935.org/gj/ver.txt?rand=2926343151</li>
<li>http://down.9935.org/gj/ver.txt?rand=3491847295</li>
<li>http://down.9935.org/gj/ver.txt?rand=2034781527</li>
<li>http://down.9935.org/gj/ver.txt?rand=954022402</li>
<li>http://down.9935.org/gj/ver.txt?rand=340006253</li>
<li>http://down.9935.org/gj/ver.txt?rand=1941824033</li>
<li>http://down.9935.org/gj/ver.txt?rand=2273862885</li>
<li>http://down.9935.org/gj/ver.txt?rand=1206191757</li>
<li>http://down.9935.org/gj/ver.txt?rand=1964310251</li>
<li>http://down.9935.org/gj/ver.txt?rand=2538982626</li>
<li>http://down.9935.org/gj/ver.txt?rand=4276649877</li>
<li>http://down.9935.org/gj/ver.txt?rand=3289240762</li>
<li>http://down.9935.org/gj/ver.txt?rand=3338973192</li>
<li>http://down.9935.org/gj/ver.txt?rand=2953703371</li>
<li>http://down.9935.org/gj/ver.txt?rand=4016579219</li>
<li>http://down.9935.org/gj/ver.txt?rand=3176473095</li>
<li>http://down.9935.org/gj/ver.txt?rand=437524180</li>
<li>http://down.9935.org/gj/ver.txt?rand=3454396861</li>
<li>http://down.9935.org/gj/ver.txt?rand=1762174418</li>
<li>http://down.9935.org/gj/ver.txt?rand=1136512953</li>
<li>http://down.9935.org/gj/ver.txt?rand=2118399524</li>
<li>http://down.9935.org/gj/ver.txt?rand=14499682</li>
<li>http://down.9935.org/gj/ver.txt?rand=3798407456</li>
<li>http://down.9935.org/gj/ver.txt?rand=583309349</li>
<li>http://down.9935.org/gj/ver.txt?rand=3488820463</li>
<li>http://down.9935.org/gj/ver.txt?rand=1916020835</li>
<li>http://down.9935.org/gj/ver.txt?rand=1506257827</li>
<li>http://down.9935.org/gj/ver.txt?rand=2666317412</li>
<li>http://down.9935.org/gj/ver.txt?rand=568585823</li>
<li>http://down.9935.org/gj/ver.txt?rand=2330776542</li>
<li>http://down.9935.org/gj/ver.txt?rand=1246173043</li>
<li>http://down.9935.org/gj/ver.txt?rand=2553603267</li>
<li>http://down.9935.org/gj/ver.txt?rand=3306421065</li>
<li>http://down.9935.org/gj/ver.txt?rand=3705965125</li>
<li>http://down.9935.org/gj/ver.txt?rand=1544019413</li>
<li>http://down.9935.org/gj/ver.txt?rand=2596040495</li>
<li>http://down.9935.org/gj/ver.txt?rand=3108176790</li>
<li>http://down.9935.org/gj/ver.txt?rand=2682010088</li>
<li>http://down.9935.org/gj/ver.txt?rand=4274461007</li>
<li>http://down.9935.org/gj/ver.txt?rand=1313121557</li>
<li>http://down.9935.org/gj/ver.txt?rand=3465804175</li>
<li>http://down.9935.org/gj/ver.txt?rand=2280977974</li>
<li>http://down.9935.org/gj/ver.txt?rand=4234528095</li>
<li>http://down.9935.org/gj/ver.txt?rand=443182089</li>
<li>http://down.9935.org/gj/ver.txt</li>
</ul></ul>
<ul><li>The following Internet download was started (the retrieved bits are saved into the local file):</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0">
<tr><td class="cell_1_h">URL to be downloaded</td><td class="cell_2_h">Filename for the downloaded bits</td></tr>
<tr><td class="cell_1">http://update.ttliuliang.com/update/107872/update/update_stworker.txt?rnd=1463414437</td><td class="cell_2">%FontsDir%\win\update.txt</td></tr>
</table></p>
<ul><li>Notes:</li><ul>
<li>%FontsDir% is a variable that refers to a virtual folder containing fonts. A typical path is C:\Windows\Fonts.</li>
</ul></ul>
<p>&nbsp;</p><div class="discl">
<table cellpadding="0" cellspacing="0" style="width:100%"><tr><td width="100%" class="h3">&nbsp;</td></tr></table>
<p>All content ("Information") contained in this report is the copyrighted work of Threat Expert Ltd and its associated companies ("ThreatExpert") and may not be copied without the express permission of ThreatExpert.</p>
<p>The Information is provided on an "as is" basis. ThreatExpert disclaims all warranties, whether express or implied, to the maximum extent permitted by law, including the implied warranties that the Information is merchantable, of satisfactory quality, accurate, fit for a particular purpose or need, or non-infringing, unless such implied warranties are legally incapable of exclusion. Further, ThreatExpert does not warrant or make any representations regarding the use or the results of the use of the Information in terms of their correctness, accuracy, reliability, or otherwise.</p>
<p style="color: #000000">Copyright &copy; 2016 <a href="http://www.threatexpert.com" style="color: #000000">ThreatExpert</a>. All rights reserved.</p></div>
</body></html>
