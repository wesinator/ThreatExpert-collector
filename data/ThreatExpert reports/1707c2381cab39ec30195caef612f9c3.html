<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<HTML><head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="description" content="ThreatExpert Report: Backdoor:Win32/Farfli.K, Backdoor.Win32.Farfli, BackDoor-DVB, Trojan.Win32.MMM">
<style type="text/css">body a {color: #505050;	text-decoration: none} body a:hover {color: #c00000; text-decoration: underline}</style>
<link href="./css/report.css" rel="stylesheet" type="text/css"/>
<title>ThreatExpert Report: Backdoor:Win32/Farfli.K, Backdoor.Win32.Farfli, BackDoor-DVB, Trojan.Win32.MMM</title>
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script>
<script type="text/javascript">_uacct = "UA-1490218-5";_udn="threatexpert.com";urchinTracker();</script>
</head><body>
<table align="right"><tr class="top_link"><td><a href="http://www.threatexpert.com">Visit ThreatExpert web site</a></td>
<td style="color: #707070">|</td><td><a href="javascript:window.close();">Close Report</a></td></tr></table>
<a href="http://www.threatexpert.com"><img src="./resources/logo.gif" style="border: none"/></a>
<h2>Submission Summary:</h2>
<ul><li>Submission details:</li><ul>
<li>Submission received: 23 May 2016, 12:19:34</li>
<li>Processing time: 5 min 39 sec</li>
<li>Submitted sample:</li>
<ul>
<li>File MD5: 0x1707C2381CAB39EC30195CAEF612F9C3</li>
<li>File SHA-1: 0xB778EB859A30CB780086B74005721B0170C82C98</li>
<li>Filesize: 88,080 bytes</li>
<li>Alias:</li>
<ul><li><a href="http://www.threatexpert.com/threats/backdoor-win32-farfli-k.html" target="_blank">Backdoor:Win32/Farfli.K<img src="./resources/flag.gif" style="border:none"/></a> [Microsoft]</li>
<li><a href="http://www.threatexpert.com/threats/backdoor-win32-farfli.html" target="_blank">Backdoor.Win32.Farfli<img src="./resources/flag.gif" style="border:none"/></a> [Ikarus]</li>
</ul>
</ul>
</ul></ul>
<ul><li>Summary of the findings:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0" width="570px">
<tr><td class="cell_1_h">What's been found</td><td class="cell_2_h">Severity Level</td></tr>
<tr><td class="cell_1">Produces outbound traffic.</td><td class="cell_2"><img src="./resources/level1.gif"></td></tr>
</table></p>
<p>&nbsp;</p><h2>Technical Details:</h2>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/file_mod.gif"/></td><td width="100%" class="h3">File System Modifications</td></tr></table>
<ul><li>The following files were created in the system:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0">
<tr><td class="cell_1_h">#</td><td class="cell_1_h">Filename(s)</td><td class="cell_1_h">File Size</td><td class="cell_1_h">File Hash</td><td class="cell_2_h">Alias</td></tr>
<tr><td class="cell_1">1</td>
<td class="cell_1">
%System%\AYSP2.dll
</td>
<td class="cell_1">118,402 bytes</td>
<td class="cell_1">MD5: 0x03A831674C665793AA4592CA6FEFAB22<br/>SHA-1: 0xE05898FA67BCE0F6142BCC04F60F6EB867C5E2B6</td>
<td class="cell_2"><a href="http://www.threatexpert.com/threats/backdoor-dvb.html" target="_blank">BackDoor-DVB<img src="./resources/flag.gif" style="border:none"/></a> [McAfee]<br/><a href="http://www.threatexpert.com/threats/backdoor-win32-farfli-k.html" target="_blank">Backdoor:Win32/Farfli.K<img src="./resources/flag.gif" style="border:none"/></a> [Microsoft]<br/><a href="http://www.threatexpert.com/threats/trojan-win32-mmm.html" target="_blank">Trojan.Win32.MMM<img src="./resources/flag.gif" style="border:none"/></a> [Ikarus]</td>
</tr>
<tr><td class="cell_1">2</td>
<td class="cell_1">
[file and pathname of the sample #1]
</td>
<td class="cell_1">88,080 bytes</td>
<td class="cell_1">MD5: 0x1707C2381CAB39EC30195CAEF612F9C3<br/>SHA-1: 0xB778EB859A30CB780086B74005721B0170C82C98</td>
<td class="cell_2"><a href="http://www.threatexpert.com/threats/backdoor-win32-farfli-k.html" target="_blank">Backdoor:Win32/Farfli.K<img src="./resources/flag.gif" style="border:none"/></a> [Microsoft]<br/><a href="http://www.threatexpert.com/threats/backdoor-win32-farfli.html" target="_blank">Backdoor.Win32.Farfli<img src="./resources/flag.gif" style="border:none"/></a> [Ikarus]</td>
</tr>
</table></p>
<ul><li>Note:</li><ul>
<li>%System% is a variable that refers to the System folder. By default, this is C:\Windows\System (Windows 95/98/Me), C:\Winnt\System32 (Windows NT/2000), or C:\Windows\System32 (Windows XP).</li>
</ul></ul>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/mem_mod.gif"/></td><td width="100%" class="h3">Memory Modifications</td></tr></table>
<ul><li>There was a new process created in the system:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0">
<tr><td class="cell_1_h">Process Name</td><td class="cell_1_h">Process Filename</td><td class="cell_2_h">Main Module Size</td></tr>
<tr><td class="cell_1">[filename of the sample #1]</td><td class="cell_1">[file and pathname of the sample #1]</td><td class="cell_2">225,280 bytes</td></tr>
</table></p>
<ul><li>The following module was loaded into the address space of other process(es):</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0">
<tr><td class="cell_1_h">Module Name</td><td class="cell_1_h">Module Filename</td><td class="cell_2_h">Address Space Details</td></tr>
<tr><td class="cell_1">aysp2.dll</td><td class="cell_1">%System%\aysp2.dll</td><td class="cell_2">Process name: <a href="http://www.threatexpert.com/files/svchost.exe.html" target="_blank">svchost.exe<img src="./resources/flag.gif" style="border:none"/></a><br/>Process filename: %System%\<a href="http://www.threatexpert.com/files/svchost.exe.html" target="_blank">svchost.exe<img src="./resources/flag.gif" style="border:none"/></a><br/>Address space: 0x5A0000 - 0x5BF000</td></tr>
</table></p>
<ul><li>There was a new service created in the system:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0">
<tr><td class="cell_1_h">Service Name</td><td class="cell_1_h">Display Name</td><td class="cell_1_h">Status</td><td class="cell_2_h">Service Filename</td></tr>
<tr><td class="cell_1">Microsoft MR</td><td class="cell_1">Microsoft Device Manager</td><td class="cell_1">"Running"</td><td class="cell_2">%System%\svchost.exe -k netsvcs</td></tr>
</table></p>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/reg_mod.gif"/></td><td width="100%" class="h3">Registry Modifications</td></tr></table>
<ul><li>The following Registry Keys were created:</li>
<ul>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\MediaResources\msvideo</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\LEGACY_MICROSOFT_MR</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\LEGACY_MICROSOFT_MR\0000</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\LEGACY_MICROSOFT_MR\0000\Control</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Microsoft MR</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Microsoft MR\Parameters</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Microsoft MR\Security</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Microsoft MR\Enum</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\MediaResources\msvideo</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_MICROSOFT_MR</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_MICROSOFT_MR\0000</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_MICROSOFT_MR\0000\Control</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Microsoft MR</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Microsoft MR\Parameters</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Microsoft MR\Security</li>
<li>HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Microsoft MR\Enum</li>
</ul></ul>
<ul><li>The newly created Registry Values are:</li><ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\LEGACY_MICROSOFT_MR\0000\Control]</li><ul>
<li>*NewlyCreated* = 0x00000000</li>
<li>ActiveService = "Microsoft MR"</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\LEGACY_MICROSOFT_MR\0000]</li><ul>
<li>Service = "Microsoft MR"</li>
<li>Legacy = 0x00000001</li>
<li>ConfigFlags = 0x00000000</li>
<li>Class = "LegacyDriver"</li>
<li>ClassGUID = "{8ECC055D-047F-11D1-A537-0000F8753ED1}"</li>
<li>DeviceDesc = "Microsoft Device Manager"</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Enum\Root\LEGACY_MICROSOFT_MR]</li><ul>
<li>NextInstance = 0x00000001</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Microsoft MR\Enum]</li><ul>
<li>0 = "Root\LEGACY_MICROSOFT_MR\0000"</li>
<li>Count = 0x00000001</li>
<li>NextInstance = 0x00000001</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Microsoft MR\Security]</li><ul>
<li>Security = 01 00 14 80 90 00 00 00 9C 00 00 00 14 00 00 00 30 00 00 00 02 00 1C 00 01 00 00 00 02 80 14 00 FF 01 0F 00 01 01 00 00 00 00 00 01 00 00 00 00 02 00 60 00 04 00 00 00 00 00 14 00 FD 01 02 00 01 01 00 00 00 00 00 05 12 00 00 00 00 00 18 00 FF 01 0F 0</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Microsoft MR\Parameters]</li><ul>
<li>ServiceDll = "%System%\AYSP2.dll"</li>
<li>ServiceMain = "FUCK"</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Services\Microsoft MR]</li><ul>
<li>Type = 0x00000120</li>
<li>Start = 0x00000002</li>
<li>ErrorControl = 0x00000001</li>
<li>ImagePath = "%System%\svchost.exe -k netsvcs"</li>
<li>DisplayName = "Microsoft Device Manager"</li>
<li>ObjectName = "LocalSystem"</li>
<li>Description = "?????????????????????????????"</li>
<li>ConnectGroup = "????"</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_MICROSOFT_MR\0000\Control]</li><ul>
<li>*NewlyCreated* = 0x00000000</li>
<li>ActiveService = "Microsoft MR"</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_MICROSOFT_MR\0000]</li><ul>
<li>Service = "Microsoft MR"</li>
<li>Legacy = 0x00000001</li>
<li>ConfigFlags = 0x00000000</li>
<li>Class = "LegacyDriver"</li>
<li>ClassGUID = "{8ECC055D-047F-11D1-A537-0000F8753ED1}"</li>
<li>DeviceDesc = "Microsoft Device Manager"</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Enum\Root\LEGACY_MICROSOFT_MR]</li><ul>
<li>NextInstance = 0x00000001</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Microsoft MR\Enum]</li><ul>
<li>0 = "Root\LEGACY_MICROSOFT_MR\0000"</li>
<li>Count = 0x00000001</li>
<li>NextInstance = 0x00000001</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Microsoft MR\Security]</li><ul>
<li>Security = 01 00 14 80 90 00 00 00 9C 00 00 00 14 00 00 00 30 00 00 00 02 00 1C 00 01 00 00 00 02 80 14 00 FF 01 0F 00 01 01 00 00 00 00 00 01 00 00 00 00 02 00 60 00 04 00 00 00 00 00 14 00 FD 01 02 00 01 01 00 00 00 00 00 05 12 00 00 00 00 00 18 00 FF 01 0F 0</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Microsoft MR\Parameters]</li><ul>
<li>ServiceDll = "%System%\AYSP2.dll"</li>
<li>ServiceMain = "FUCK"</li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\Microsoft MR]</li><ul>
<li>Type = 0x00000120</li>
<li>Start = 0x00000002</li>
<li>ErrorControl = 0x00000001</li>
<li>ImagePath = "%System%\svchost.exe -k netsvcs"</li>
<li>DisplayName = "Microsoft Device Manager"</li>
<li>ObjectName = "LocalSystem"</li>
<li>Description = "?????????????????????????????"</li>
<li>ConnectGroup = "????"</li>
</ul>
</ul></ul>
<ul><li>The following Registry Values were modified:</li><ul>
<li>[HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\SvcHost]</li><ul>
<li>netsvcs = </li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\ServiceCurrent]</li><ul>
<li>(Default) = </li>
</ul>
<li>[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\ServiceCurrent]</li><ul>
<li>(Default) = </li>
</ul>
</ul></ul>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/other_mod.gif"/></td><td width="100%" class="h3">Other details</td></tr></table>
<ul><li>Analysis of the file resources indicate the following possible country of origin:</li></ul>
<p><table class="tbl" cellpadding="15" cellspacing="0">
<tr>
<tr><td class="cell_1"><img src="./resources/flags/china.gif"></td>
<td class="cell_2">China</td><tr>
</table></p>
<ul><li>The following Host Name was requested from a host database:</li>
<ul>
<li>ddosdnsftth.com</li>
</ul></ul>
<ul><li>There was registered attempt to establish connection with the remote host. The connection details are:</li></ul>
<p><table class="tbl" cellpadding="5" cellspacing="0">
<tr><td class="cell_1_h">Remote Host</td><td class="cell_2_h">Port Number</td></tr>
<tr><td class="cell_1">ddosdnsftth.com<td class="cell_2">83</td><tr>
</table></p>
<p>&nbsp;</p><table cellpadding="0" cellspacing="0" style="width:100%"><tr><td><img style="border: none" src="./resources/traffic_mod.gif"/></td><td width="100%" class="h3">Outbound traffic (potentially malicious)</td></tr></table>
<ul><li>There was an outbound traffic produced on port 83:</li></ul>
<p><table class="tbl" cellpadding="0" cellspacing="0"><tr><td>
<textarea style="color:#505050;border-style:none; font-family:'Courier New', Courier, mono; font-size:11px" name="textarea" cols="80" rows="7">
00000000 | 4768 3073 74E2 0000 0048 0100 0078 9C4B | Gh0st....H...x.K
00000010 | 6360 6098 03C4 AC40 CC08 C41A 5C0C 0C4C | c``....@....\..L
00000020 | 403A 38B5 A82C 3339 5521 2031 395B C188 | @:8..,39U! 19[..
00000030 | E17F 45F8 D2C2 F5A1 4B0B 15CA B818 22E2 | ..E.....K.....".
00000040 | 5A18 0480 6ACE 00F9 4F80 18C8 64D8 3CAF | Z...j...O...d.<.
00000050 | A106 4497 7237 D66C 6740 053E 312D 60FA | ..D.r7.lg@.>1-`.
00000060 | 04EB C49A 07C7 B919 2462 5B18 0281 EC15 | ........$b[.....
00000070 | EC9C 0CB9 407A B1D8 CAC2 14A0 D80F A0D9 | ....@z..........
00000080 | 20F3 1380 EA41 6E60 6064 64D8 CECD C060 |  ....An``dd....`
00000090 | C830 A126 C277 6961 00D0 811E 8C10 33EB | .0.&.wia......3.
000000A0 | 81B2 CEF9 B905 A525 A945 7E89 B9A9 0C44 | .......%.E~....D
000000B0 | 81D5 85FF 81E4 6F76 08AF 1688 7D13 8B4B | ......ov....}..K
000000C0 | 32D3 D2C0 721F 80F8 06D4 AD02 40F7 4CE5 | 2...r.......@.L.
000000D0 | 9858 0312 07F1 775E 3AF4 169F C900 D5B5 | .X....w^:.......
000000E0 | 4186                                    | A.
</textarea></tr></td></table></p>
<p>&nbsp;</p><div class="discl">
<table cellpadding="0" cellspacing="0" style="width:100%"><tr><td width="100%" class="h3">&nbsp;</td></tr></table>
<p>All content ("Information") contained in this report is the copyrighted work of Threat Expert Ltd and its associated companies ("ThreatExpert") and may not be copied without the express permission of ThreatExpert.</p>
<p>The Information is provided on an "as is" basis. ThreatExpert disclaims all warranties, whether express or implied, to the maximum extent permitted by law, including the implied warranties that the Information is merchantable, of satisfactory quality, accurate, fit for a particular purpose or need, or non-infringing, unless such implied warranties are legally incapable of exclusion. Further, ThreatExpert does not warrant or make any representations regarding the use or the results of the use of the Information in terms of their correctness, accuracy, reliability, or otherwise.</p>
<p style="color: #000000">Copyright &copy; 2016 <a href="http://www.threatexpert.com" style="color: #000000">ThreatExpert</a>. All rights reserved.</p></div>
</body></html>
